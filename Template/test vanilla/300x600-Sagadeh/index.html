<!DOCTYPE html>
<html lang="en">
<head>
	<meta name="ad.size" id="adSize">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<script src="https://s0.2mdn.net/ads/studio/Enabler.js"></script>
	<link rel="stylesheet" type="text/css" href="https://s0.2mdn.net/creatives/assets/3915781/adlib.css">
	<script src="https://s0.2mdn.net/ads/studio/cached_libs/gsap_3.2.4_min.js"></script>
	<script src="https://s0.2mdn.net/creatives/assets/3915781/SplitText.min.js"></script>
	<script src="https://s0.2mdn.net/creatives/assets/3915781/adlibUtils-v3.js"></script>
	<style type="text/css">
		p{
			margin: 0 auto;
		}
        @font-face {
          font-family: VMCircularNatter-Medium;
          src: url("VMCircularNatter-Medium.woff") format("woff");
        }
        @font-face {
          font-family: VMCircularShout-Bold;
          src: url("VMCircularShout-Bold.woff") format("woff");
        }
        @font-face {
          font-family: VMCircularYell-Black;
          src: url("VMCircularYell-Black.woff") format("woff");
        }
		#main {
			position: absolute;
			top: 0;
			left: 0;
			border: 1px solid #000;
			box-sizing: border-box;
			overflow: hidden;
		}
        .img-fill {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: fill;
        }
        .aligned-v-h-centered {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #frame1Headline-wrapper {
            position: absolute;
            margin: auto;
            perspective: 1000px;
            top: 297px;
            left: 0;
            right: 0;
            width: 246px;
            height: 130px;
        }
        #frame1Headline {
            position: absolute;
            top: 0px;
            left: 0px;
            width: auto;
            height: auto;
            font-family: VMCircularYell-Black;
            font-size: 30px;
            letter-spacing: -0.9px;
            line-height: 30px;
            color: rgb(255, 255, 255);
        }
        #frame2Headline-wrapper {
            position: absolute;
            top: 18px;
            left: 25px;
            width: 237px;
            height: 120px;
        }
        #frame2Headline {
            position: absolute;
            top: 0px;
            left: 0px;
            width: auto;
            height: auto;
            text-align: left;
            font-size: 35px;
            font-family: VMCircularShout-Bold;
            letter-spacing: -1.05px;
            line-height: 35px;
            color: rgb(255, 255, 255);
        }
        #logo-wrapper {
            position: absolute;
            top: 501px;
            left: 150px;
            width: 123px;
            height: 72px;
        }
        #logo {
            position: absolute;
            width: inherit;
            height: inherit;
        }
        #cta-wrapper {
            position: absolute;
            top: 460px;
            left: 29px;
            width: 100px;
            height: 28px;
            border-radius: 14px;
            background: rgb(49,34,49);
            perspective: 1000px;
        }
        #ctaText {
            width: auto;
            height: auto;
            font-family: VMCircularNatter-Medium;
            font-size: 14px;
            letter-spacing: -0.03em;
            line-height: 25px;
            text-align: center;
            color: rgb(255, 255, 255);
        }
        #legal-btn-wrapper {
            position: absolute;
            top: 562px;
            left: 27px;
            width: 70px;
            height: 20px;
            cursor: pointer;
        }
        #legalButton {
            position: absolute;
            left: 0px;
            width: auto;
            height: auto;
            font-family: VMCircularShout-Bold;
            font-size: 10px;
            color: rgb(255, 255, 255);
        }
        #legal-text-wrapper {
            position: absolute;
            bottom: -84px;
            width: 300px;
            height: 84px;
            background: white;
            perspective: 1000px;
        }
        #legal {
            width: 280px;
            height: 65x;
            font-size: 9px;
            text-align: left;
            font-family: VMCircularNatter-Medium;
        }
        #close {
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 8px;
            font-family: VMCircularNatter-Medium;
        }
        #legal-close-btn {
            position: absolute;
            top: 0px;
            right: 0px;
            width: 50px;
            height: 20px;
            cursor: pointer;
        }
		#taparea, #taparea-legal {
			position: absolute;
			top: 0px;
			left: 0px;
			width: 100%;
			height: 100%;
			cursor: pointer;
		}
	</style>
</head>
<body>
	<div id="main" adlib-style="bgColor">
        <!--FRAME 1-->
        <div id=frame1Image-wrapper class="img-fill">
            <img id="frame1Image" src="" class="img-fill" adlib-image="frame1Image">
        </div>
        <div id=frame1Headline-wrapper>
            <div id="frame1Headline" adlib-text="frame1Headline"></div>
        </div>
        <!--FRAME 2-->
        <div id=frame2Image-wrapper class="img-fill">
            <img id="frame2Image" src="" class="img-fill" adlib-image="frame2Image">
        </div>
        <div id=frame2Image2-wrapper class="img-fill">
            <img id="frame2Image2" src="" class="img-fill" adlib-image="frame2Image2">
        </div>
        <div id=frame2Headline-wrapper>
            <div id="frame2Headline" adlib-text="frame2Headline"></div>
        </div>
        <!--LOGO-->
        <div id=logo-wrapper>
            <img id="logo" src="" adlib-image="logo">
        </div>
        <!--CTA-->
        <div id=cta-wrapper class="aligned-v-h-centered">
            <div id="ctaText" adlib-text="ctaText"></div>
        </div>
		<div id="taparea"></div>
        <!--LEGAL-->
        <div id=legal-btn-wrapper class="aligned-v-h-centered">
            <div id="legalButton" adlib-text="legalButton"></div>
        </div>
        <div id="legal-text-wrapper" class="aligned-v-h-centered">
            <div id="legal" adlib-text="legal"></div>
            <div id="close">CLOSE X</div>
            <div id="taparea-legal"></div>
            <div id="legal-close-btn"></div>
        </div>
	</div>

	<script>
        "use strict"
        var defaultValues = {
            cssAttrib:"<--custom css here->",
            startDate:"10/30/2020 0:00:00",
            endDate:"12/30/2020 0:00:00",
            frame1Headline:"Our lowest<br> ever prices this<br><span style='color: black'>Black Friday</span>",
            frame1Image:"frame1Image.png",
            frame2Headline:"Lightning-fast<br>and reliable<br>broadband",
            frame2Image:"frame2Image.png",
            frame2Image2:"frame2Image2.png",
            ctaText:"Shop now",
            legal:"VIRGIN FIBRE AREAS ONLY. New customers only. Average download speed 108Mbps. £24.99 per month. 18 month minimum term. Standard pricing applies from month 19, currently £44. £35 set up fee. Engineer installation fee (£30) may apply. Legal stuff applies. Offer ends 30/11/2020.",
            logo:"logo.png",
            legalButton:"Legal stuff&nbsp;&nbsp;^",
            bgColor:"rgb(255, 0, 0)",
            landingPage:"https://www.google.com"
        }
        
		function invocationCode() {
			// paste studio Invocation code from studio profile should be here
            Enabler.setProfileId(10587480);
            var devDynamicContent = {};

            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed = [{}];
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0]._id = 0;
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].id = 1;
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].Reporting_Label = "5fcfbc4b50eff3000680023e-5fcfbda850eff300068007e3_103";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].Active = true;
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].Weights = 1;
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].Scoring_status = "Unscored";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].frame1Headline = "Our lowest<br \/>ever prices this<br \/><span style=\"color: black;\">Black Friday<\/span>";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].landingPage = {};
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].landingPage.Url = "https://www.google.com";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].frame2Headline = "Lightning-fast<br \/>and reliable<br \/>broadband";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].frame1Image = {};
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].frame1Image.Url = "https://cdn.ad-lib.io/v3/partners/5c262b2176eeb1998929e57f/assets/singleFiles/5fd72e6150eff30006877095/original/frame1Image.png";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].frame2Image = {};
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].frame2Image.Url = "https://cdn.ad-lib.io/v3/partners/5c262b2176eeb1998929e57f/assets/singleFiles/5fd72e7d50eff300068770dd/original/frame2Image.png";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].frame2Image2 = {};
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].frame2Image2.Url = "https://cdn.ad-lib.io/v3/partners/5c262b2176eeb1998929e57f/assets/singleFiles/5fd72e8c50eff30006877125/original/frame2Image2.png";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].ctaText = "Shop now";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].legal = "VIRGIN FIBRE AREAS ONLY. New customers only. Average download speed 108Mbps. &pound;24.99 per month. 18 month minimum term. Standard pricing applies from month 19, currently &pound;44. &pound;35 set up fee. Engineer installation fee (&pound;30) may apply. Legal stuff applies. Offer ends 30\/11\/2020.";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].logo = {};
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].logo.Url = "https://cdn.ad-lib.io/v3/partners/5c262b2176eeb1998929e57f/assets/singleFiles/5fd72ed450eff30006877198/original/logo.png";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].legalButton = "Legal stuff&nbsp; ^";
            devDynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0].bgColor = "rgb(255, 0, 0)";
            Enabler.setDevDynamicContent(devDynamicContent);
		}

		function dynamic() {
            try {
                !Enabler.isServingInLiveEnvironment() ? (Object.keys(defaultValues).forEach((platform) => {
                    console.log(defaultValues[platform]), defaultValues[platform];
                })) : (
                    invocationCode(),
                    Object.keys(defaultValues).forEach((studio) => {
                        if (imgKeywordArr.some(word => studio.indexOf(word) > -1) || vidKeywordArr.some(word => studio.indexOf(word) > -1) || audioKeywordArr.some(word => studio.indexOf(word) > -1) || landingPageArr.some(word => studio.indexOf(word) > -1)) {
                            try {
                                //replace 'your_feedName_here' with an actual feed | e.g Clinique_Remarketing_Q1_Remarketing_Q1_Refresh
                                defaultValues[studio] = dynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0][studio].Url;
                            } catch (Error) {}
                        } else {
                            //replace 'your_feedName_here' with an actual feed | e.g Clinique_Remarketing_Q1_Remarketing_Q1_Refresh
                            defaultValues[studio] = dynamicContent.Paolo_Test_Campaign_Virgin_Decision_Tree__Vanilla_Template_AdLib_Feed[0][studio];
                        }
                    })
                );
            } catch (Error) {}
        }

		function populate() {
            document.querySelectorAll('body *').forEach(val => {
				if(val.getAttribute('adlib-text') != null) {
					document.querySelector('#'+val.id).innerHTML = defaultValues[val.getAttribute('adlib-text')];
				}
				if(val.getAttribute('adlib-image') != null) {
					document.querySelector('#'+val.id).src = defaultValues[val.getAttribute('adlib-image')];
				}
                if(val.getAttribute('adlib-style') != null) {
					document.querySelector('#'+val.id).style.backgroundColor = defaultValues[val.getAttribute('adlib-style')];
				}
            })
		}

		window.gwd = window.gwd || {};
        //Tool Play and Pause
        gwd.auto_PauseBtnClick = function (event) {
        	gsap.globalTimeline.pause(); 
        	console.log("Pause Timeline");
        };
        gwd.auto_PlayBtnClick = function (event) {
        	gsap.globalTimeline.resume(); 
        	console.log("Play Timeline");
        };

        //* * * * * * * * ALL ANIMATION RELATED CODE SHOULD START HERE * * * * * * * 

        // set initial position of your elements here
        gsap.set(["#main"], {visibility: "hidden"});
        gsap.globalTimeline.pause();

        function init() {
            dynamic();
		    templateCSS(defaultValues.cssAttrib); 
            adlib.creativeSize(300,600); //just replace this with the creative size
		    adlibStart();
		    populate();
            startAnimation();
            buttonEventListeners();
		}
		function startAnimation() {
			console.log("startAnimation")
			gsap.globalTimeline.resume();
            
            var tl = gsap.timeline({onComplete: animationEnd});
            //FRAME 1 ANIMATION
            tl.to("#main", {duration: 0.5, visibility: "visible"})
              .from("#frame1Headline", {duration: 0.5, opacity: 0, force3D: false, onComplete: takeScreenshot})
            //FRAME 2 ANIMATION
              .to("#frame1Image, #frame1Headline", {duration: 0.5, opacity: 0},'+=2')
              .from("#frame2Headline", {duration: 0.5, opacity: 0, force3D: false})
              .from("#frame2Image", {duration: 0.5, opacity: 0})
              .from("#frame2Image2", {duration: 0.5, opacity: 0})
              .from("#cta-wrapper", {duration: 0.5, y: "50%", opacity: 0, force3D: false});
        }
        function animationEnd() {
             // call this function on the very end of the last animation.
             takeScreenshot();
             setTimeout(function() {adlibEnd();},1000);
        }
        function buttonEventListeners() {
            document.getElementById("taparea").addEventListener("click", clickThrough);
            document.getElementById("taparea-legal").addEventListener("click", clickThrough);
            document.getElementById("legal-btn-wrapper").addEventListener("mouseover", legalMouseOver);
            document.getElementById("legal-close-btn").addEventListener("click", closeLegalClick);
        }
        function clickThrough() {
            Enabler.exitOverride("Clickthrough", defaultValues.landingPage);
        }
        function legalMouseOver() {
            gsap.to("#legal-text-wrapper", {duration: 0.25, y: "-100%", force3D: false});
        }
        function closeLegalClick() {
            gsap.to("#legal-text-wrapper", {duration: 0.25, y: "0%", force3D: false});
        }

        gsap.ticker.fps(30);

        window.onload = function () {
        	if (Enabler.isInitialized()) {
        		enablerInitHandler();
        	} else {
        		Enabler.addEventListener(studio.events.StudioEvent.INIT, enablerInitHandler);
        	}
        }
        function enablerInitHandler() {
        	init();
            // this is from engineering team. this is strictly required
            var event = new CustomEvent("adinitialized");
            document.dispatchEvent(event);

        }
        var adlib = {
			creativeSize: function(cWidth,cHeight) {
				document.querySelector("#main").style.width = cWidth +"px";
				document.querySelector("#main").style.height = cHeight +"px";
				document. getElementById("adSize").setAttribute("content", "width="+cWidth+", "+ "height="+cHeight+"");
				//setTimeout(function(){populate();initAnim();},100);	
			}
		}
        
    </script>
</body>
</html>

